<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Title</title>
    <!-- Required meta tags -->
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />

    <!-- Bootstrap CSS v5.2.1 -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN"
      crossorigin="anonymous"
    />
    <link
      rel="stylesheet"
      href="https://unpkg.com/leaflet@1.6.0/dist/leaflet.css"
    />
    <script src="https://unpkg.com/leaflet@1.6.0/dist/leaflet.js"></script>
  </head>

  <body>
    <div class="container">
      <div id="map"></div>
    </div>

    <script
      src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js"
      integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js"
      integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r"
      crossorigin="anonymous"
    ></script>

    <script>
      function initializeMap(data) {
        return new Promise((resolve, reject) => {
          try {
            var map = L.map("map").setView([51.505, -0.09], 13);

            L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
              attribution:
                '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',
            }).addTo(map);

            data.forEach((item) => {
              const lat = item.lat;
              const lng = item.lng;
              const img=`<img src="https://unimap.wingzero.tw/uniform/${item.location}/${item.code}//${item.school_pic}">`

              L.marker([lat, lng])
                .addTo(map)
                .bindPopup(`<h3`);
            });

            resolve(map);
          } catch (error) {
            reject(error);
          }
        });
      }

      axios
        .get("taoyuan.json")
        .then((response) => {
          // console.log(response);
          let schools = response.data;
          schools.forEach((school) => {
            console.log(school);
            let schoolCard = ` <div class="col-lg-3 col-md-4 col-sm-6">
          <div class="card p-3">
            <h2 class="h3 text-center">${school.name}</h2>
            <div class="d-grid">
              <button 
              data-name="${school.name}" 
              data-lom="${school.lng}" 
              data-lat="${school.lat}" 
              class="btn btn-primary">get info</button>
            </div>
          </div>
        </div>`;
            $("#schools").append(schoolCard);
          });
          $(".btn").click(function () {
            let name = $(this).data("name");
            let lat = $(this).data("lat");
            let lon = $(this).data("lon");
            // console.log(name);
            $("#name").text(name);
            $("#lat").text(lat);
            $("#lon").text(lon);
            // console.log($(this).data("school"));
          });
        })
        .catch((error) => {
          console.error(error);
        });
    </script>
  </body>
</html>
